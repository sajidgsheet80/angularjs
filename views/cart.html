<div class="cart-container">
    <!-- Order Success Message -->
    <div ng-if="orderPlaced" class="success-message">
        <div class="success-icon">✓</div>
        <h2>Order Placed Successfully!</h2>
        <p>Order #{{placedOrder.id}}</p>
        <p>Thank you for your order, {{placedOrder.customerInfo.name}}!</p>
        <p>Redirecting to orders page...</p>
    </div>

    <!-- Cart View -->
    <div ng-if="!showCheckout && !orderPlaced">
        <h2>Shopping Cart</h2>

        <div ng-if="isCartEmpty()" class="empty-cart">
            <p>Your cart is empty</p>
            <button ng-click="continueShopping()" class="btn-primary">Start Shopping</button>
        </div>

        <div ng-if="!isCartEmpty()">
            <div class="cart-items">
                <div ng-repeat="item in cartItems" class="cart-item">
                    <div class="cart-item-image">{{item.image}}</div>
                    <div class="cart-item-details">
                        <h3>{{item.name}}</h3>
                        <p class="cart-item-price">{{item.price | currency}} each</p>
                    </div>
                    <div class="cart-item-quantity">
                        <label>Quantity:</label>
                        <input type="number" 
                               ng-model="item.quantity" 
                               ng-change="updateQuantity(item.id, item.quantity)"
                               min="1" 
                               max="99">
                    </div>
                    <div class="cart-item-total">
                        <strong>{{(item.price * item.quantity) | currency}}</strong>
                    </div>
                    <button ng-click="removeItem(item.id)" class="btn-remove">✕</button>
                </div>
            </div>

            <div class="cart-summary">
                <div class="summary-row">
                    <span>Subtotal:</span>
                    <strong>{{getTotal() | currency}}</strong>
                </div>
                <div class="summary-row">
                    <span>Delivery Fee:</span>
                    <strong>$3.99</strong>
                </div>
                <div class="summary-row total-row">
                    <span>Total:</span>
                    <strong>{{(getTotal() + 3.99) | currency}}</strong>
                </div>
            </div>

            <div class="cart-actions">
                <button ng-click="continueShopping()" class="btn-secondary">Continue Shopping</button>
                <button ng-click="proceedToCheckout()" class="btn-primary">Proceed to Checkout</button>
            </div>
        </div>
    </div>

    <!-- Checkout Form -->
    <div ng-if="showCheckout && !orderPlaced" class="checkout-container">
        <h2>Checkout</h2>
        
        <form name="checkoutForm" ng-submit="placeOrder()" novalidate>
            <div class="form-section">
                <h3>Delivery Information</h3>
                
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" 
                           ng-model="customerInfo.name" 
                           name="name"
                           required 
                           class="form-control">
                    <span class="error" ng-show="checkoutForm.name.$touched && checkoutForm.name.$invalid">
                        Name is required
                    </span>
                </div>

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" 
                           ng-model="customerInfo.email" 
                           name="email"
                           required 
                           class="form-control">
                    <span class="error" ng-show="checkoutForm.email.$touched && checkoutForm.email.$invalid">
                        Valid email is required
                    </span>
                </div>

                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" 
                           ng-model="customerInfo.phone" 
                           name="phone"
                           required 
                           class="form-control">
                    <span class="error" ng-show="checkoutForm.phone.$touched && checkoutForm.phone.$invalid">
                        Phone number is required
                    </span>
                </div>

                <div class="form-group">
                    <label>Delivery Address *</label>
                    <input type="text" 
                           ng-model="customerInfo.address" 
                           name="address"
                           required 
                           class="form-control">
                    <span class="error" ng-show="checkoutForm.address.$touched && checkoutForm.address.$invalid">
                        Address is required
                    </span>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>City *</label>
                        <input type="text" 
                               ng-model="customerInfo.city" 
                               name="city"
                               required 
                               class="form-control">
                        <span class="error" ng-show="checkoutForm.city.$touched && checkoutForm.city.$invalid">
                            City is required
                        </span>
                    </div>

                    <div class="form-group">
                        <label>ZIP Code *</label>
                        <input type="text" 
                               ng-model="customerInfo.zipCode" 
                               name="zipCode"
                               required 
                               class="form-control">
                        <span class="error" ng-show="checkoutForm.zipCode.$touched && checkoutForm.zipCode.$invalid">
                            ZIP code is required
                        </span>
                    </div>
                </div>
            </div>

            <div class="order-summary">
                <h3>Order Summary</h3>
                <div ng-repeat="item in cartItems" class="summary-item">
                    <span>{{item.name}} × {{item.quantity}}</span>
                    <span>{{(item.price * item.quantity) | currency}}</span>
                </div>
                <div class="summary-total">
                    <strong>Total (including delivery):</strong>
                    <strong>{{(getTotal() + 3.99) | currency}}</strong>
                </div>
            </div>

            <div class="checkout-actions">
                <button type="button" ng-click="backToCart()" class="btn-secondary">Back to Cart</button>
                <button type="submit" class="btn-primary">Place Order</button>
            </div>
        </form>
    </div>
</div>
